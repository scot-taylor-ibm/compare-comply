---

copyright:
  years: 2019
lastupdated: "2019-03-05"

---

{:shortdesc: .shortdesc}
{:new_window: target="_blank"}
{:tip: .tip}
{:note: .note}
{:pre: .pre}
{:important: .important}
{:deprecated: .deprecated}
{:codeblock: .codeblock}
{:screen: .screen}
{:download: .download}
{:hide-dashboard: .hide-dashboard}
{:apikey: data-credential-placeholder='apikey'}
{:url: data-credential-placeholder='url'}
{:curl: #curl .ph data-hd-programlang='curl'}
{:javascript: .ph data-hd-programlang='javascript'}
{:java: .ph data-hd-programlang='java'}
{:python: .ph data-hd-programlang='python'}
{:ruby: .ph data-hd-programlang='ruby'}
{:swift: .ph data-hd-programlang='swift'}
{:go: .ph data-hd-programlang='go'}

# High availability and disaster recovery
{: #recovery}

Disaster recovery for IBM Watson&trade; Compare and Comply is possible with proper data, model, and file backups. A typical use case is using backups to restore information to a new Compare and Comply instance in a different data center.
{: shortdesc}

### The Registration API
{: #registration-api}

Some of the following tasks use the Compare and Comply Registration API. The Registration API is currently an internal-only interface. Contact IBM Support for assistance.
{: note}

## Backing up your data 
{: #backup-data}

There are several methods for backing up the data stored in Compare and Comply. These methods need to be included in your disaster recovery plan.

  - Data you need keep a copy of, such as source documents that were processed as [batches](/docs/services/compare-comply?topic=compare-comply-batching).
  - Data in Compare and Comply data stores that you need to retrieve and store a copy of, such as customized models.
  
Some data must be recreated from scratch; for example, [feedback](/docs/services/compare-comply?topic=compare-comply-feedback) provided since the last backup.

### Batch API
{: #batch-api}

The [Batch API](/docs/services/compare-comply?topic=compare-comply-batching) uses customer-provided Cloud Object Storage (COS) buckets to read input documents and to store results.  It is recommended that you use cross-regional buckets for business-critical documents. Cross-regional buckets are automatically replicated across multiple regions and remain available if one region is offline. If you must use single-region or one-zone buckets, you must back up the data in those buckets.

If batches are a critical component of your application, some of the batch jobs might need to be run again after recovery. You must keep enough information in your application's log to be able to know, for each batch submitted, the batch ID returned by the Batch API, and the locations of the input and output buckets.

### Feedback
{: #feedback}

Feedback provided with the Compare and Comply Tooling is stored in an internal data store. Feedback entered after the time of the last backup of this store is lost. To facilitate recovery, you need to keep a log with the name of the documents loaded into the Tooling and the time they were loaded.

### Custom models
{: #custom-models}

If you used the [Registration API](#registration-api) to store custom models into the service, you must keep a backup of those models. It is useful, but not critical, to keep a log of the name and version that you gave to the registered models. You might need to re-register one or more of the models during recovery.

### Online Learning
{: #online-learning}

Online Learning enables customers to semi-automatically generate and register new models based on feedback. These local models are generated by the system and are stored internally by using the [Registration API](#registration-api). In case of a disaster, Compare and Comply is able to recover only custom models that were created before the last backup. For this reason, you need to regularly download the created models by using the `GET /v1/models/{id}/download` method in the Registration API and keep the downloaded models as backup.

## Restoring your data to a new Compare and Comply instance
{: #restoring-data}

Consider using your backups to restore to a new Compare and Comply instance in a different data center.

### Batches
{: #restore-batches}

The database containing the status of batch jobs can be up to 24 hours old. This means that Compare and Comply does not know about batches that were started or were running up to 24 hours before the disaster. This does _not_ mean that data is lost, because the data is in COS buckets. What can be lost, however, are the IDs and statuses for batch jobs that were running or started after the time of the last backup.

Use the [`GET /v1/batches`](/docs/services/compare-comply?topic=compare-comply-batching#get-list-batch) method to get a list of batch statuses known by the recovered system. Then use your application's log to get the information about the batches that were started or were running close to the time of the disaster. For batch jobs that are not listed in the output of the `GET /v1/batches` method, look in the COS output bucket of that batch job. If the bucket contains a `{batch_ID}.json` file, the file lists the final status of the batch job. If the file does not exist, then the batch job did not finish and needs to be re-submitted. Use the [`POST /v1/batches`](/docs/services/compare-comply?topic=compare-comply-batching#post-batch) method to rerun the batch job from scratch. If it was a large batch that already processed a number of input files, as determined by the corresponding JSON output files in the output bucket, you can remove the corresponding input files from the input COS bucket. The new batch job processes the remaining input file or files and adds the results to the same output bucket.

### Feedback
{: #restore-feedback}

Feedback provided by using the Compare and Comply Tooling after the time of the latest backup of the feedback data store is lost. You need to reload the documents you were using into the tool and manually redo the missing feedback. You can use the [`GET /v1/feedback`](/docs/services/compare-comply?topic=compare-comply-feedback#get_all_feedback) method to retrieve the feedback that the system knows about. Feedback objects include a creation timestamp that can give you an idea of when the last feedback was recorded.

### Custom models
{: #restore-custom-models}

Use the [Registration API](#registration-api) to register models that are not know to the system after recovery. Use the `GET /v1/models` method to get a list of known models and verify that your model and its correct version are in the store after recovery. If it is not, find the model in your backup and register it again.

### Online Learning
{: #restore-online-learning}

Online Learning depends on Feedback to create new customized models. Because some feedback can be lost after recovery, you might need to manually enter the feedback again and then redo the recommendation review and model generation exercises by using the Online Learning tool.

However, if you have a backup of the models that were generated by Online Learning, you can use the [Registration API](#registration-api) to register them into the system as described in [Custom models](#custom-models). You can then resume the Online Learning cycle on these models with the understanding that:

  - Some of the feedback that you provided before the disaster might be lost.
  - Some of the recommendations that you already inspected and accepted or rejected before the disaster might also be lost and might need to be redone by using the Tooling.
